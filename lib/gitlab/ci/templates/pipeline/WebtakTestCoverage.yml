variables:
  TEMPLATES_BASE_PATH: https://raw.githubusercontent.com/chesapeaketechnology/gitlab-templates/experimental/2.0/lib/gitlab/ci/templates/

include:
  - remote: $TEMPLATES_BASE_PATH/pipeline/NpmJestCoveragePipeline.yml

build:
  stage: build
  before_script:
    - npm config set @webtak:registry https://artifacts.tak.gov/artifactory/api/npm/WebTAK/
    - npm config set -- '//artifacts.tak.gov/artifactory/api/npm/WebTAK/:_authToken' "${TAK_API_TOKEN}"
    - npm config set -- '//artifacts.tak.gov/artifactory/api/npm/WebTAK/:email' "${TAK_EMAIL}"
    - npm config set -- '//artifacts.tak.gov/artifactory/api/npm/WebTAK/:always-auth' "true"

pages:
  stage: deploy
  before_script:
    - rm -r public/*