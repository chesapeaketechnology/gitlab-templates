gitlab_release_traceability_job:
  stage: publish
  image: registry.gitlab.com/gitlab-org/release-cli:latest
  rules:
    - if: $CI_COMMIT_TAG
  script:
    - echo "running release_job for $TAG"
  release:
    tag_name: 'v0.$CI_PIPELINE_IID'                # The version is incremented per pipeline.
    description: 'v0.$CI_PIPELINE_IID'
    ref: '$CI_COMMIT_SHA'                          # The tag is created from the pipeline SHA.
    # milestones:
    #   - 'm1'
    #   - 'm2'
    #   - 'm3'
    assets: # Optional, multiple asset links
      links:
        - name: "Security Artifacts"
          url: "https://${CI_SERVER_HOST}/${CI_PROJECT_NAMESPACE}/${CI_PROJECT_NAME}/-/jobs/${CI_JOB_ID}/artifacts/download"
  # TODO Persist artifacts indefinitely
#  artifacts:
#    # Specify artifacts from previous jobs to be persisted indefinitely
#    paths:
#      - myArtifactsPathFromJob1
#      - myArtifactsPathFromJob2
#  expire_in: never
